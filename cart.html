<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mingle Bistro â€” Cart</title>
<style>
:root{
  --gold:#D4AF37;
  --bg:#0f0f0f;
  --card:#121212;
  --muted:#bfbfbf;
  --accent:#d4af37;
  --glass: rgba(255,255,255,0.03);
}

/* Base */
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:#fff;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;-webkit-font-smoothing:antialiased}
a{color:inherit;text-decoration:none}

/* Header */
.header{
  padding:20px 16px; text-align:center; border-bottom:1px solid rgba(255,255,255,0.03);
}
.header .title{font-weight:900;color:var(--gold);font-size:22px;letter-spacing:0.6px}
.header .sub{color:var(--muted);font-size:13px;margin-top:6px}

/* Container */
.container{padding:16px;max-width:980px;margin:0 auto;}

/* Empty cart */
.empty-ct{display:flex;flex-direction:column;align-items:center;gap:12px;padding:48px 12px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border:1px solid var(--glass)}
.empty-ct .emoji{font-size:44px}
.empty-ct .lead{font-weight:800;color:var(--gold)}
.empty-ct .hint{color:var(--muted);text-align:center}

/* List */
.cart-list{display:flex;flex-direction:column;gap:12px;margin-top:14px}
.cart-item{
  display:flex;align-items:flex-start;gap:12px;padding:12px;border-radius:10px;background:var(--card);border:1px solid rgba(255,255,255,0.02);
  box-shadow:0 10px 20px rgba(0,0,0,0.5);
}
.item-left{flex:1;min-width:0}
.item-name{font-weight:800;font-size:15px;line-height:1.05}
.item-meta{color:var(--muted);font-size:13px;margin-top:6px;white-space:pre-line}
.item-right{text-align:right;display:flex;flex-direction:column;align-items:flex-end;gap:8px}
.qty-controls{display:flex;align-items:center;gap:8px;margin-top:6px}
.qty-btn{width:34px;height:34px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;font-weight:800}
.qty-val{min-width:28px;text-align:center;font-weight:800}
.remove-btn{background:transparent;border:1px solid rgba(255,255,255,0.04);color:#ddd;padding:6px 8px;border-radius:8px;cursor:pointer;font-weight:700}

/* compact price shown small */
.item-price{color:var(--muted);font-weight:800;font-size:13px}

/* subtotal bar */
.subtotal-bar{
  margin-top:18px;padding:12px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border:1px solid var(--glass);display:flex;justify-content:space-between;align-items:center;
}
.subtotal-left{color:var(--muted)}
.subtotal-right{font-weight:900;color:var(--gold);font-size:18px}

/* actions */
.actions{display:flex;gap:12px;margin-top:14px;flex-wrap:wrap}
.btn{
  padding:12px 16px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#fff;font-weight:900;cursor:pointer;
}
.btn.primary{background:var(--gold);color:#000;border-color:var(--gold);box-shadow:0 10px 30px rgba(212,175,55,0.06)}

/* success overlay */
.success-overlay{
  position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.7);z-index:120000;padding:16px;
}
.success-card{max-width:720px;width:100%;background:linear-gradient(180deg,#0f0f0f,#0b0b0b);border-radius:14px;padding:18px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 24px 60px rgba(0,0,0,0.7)}
.success-head{display:flex;align-items:center;justify-content:space-between;gap:12px}
.order-number{font-weight:900;color:var(--gold);font-size:18px}
.order-time{color:var(--muted);font-size:13px}
.success-list{margin-top:12px;display:flex;flex-direction:column;gap:10px}
.success-item{display:flex;justify-content:space-between;gap:12px;color:#ddd}
.success-meta{color:var(--muted);font-size:13px;margin-top:6px}

/* small screens tweaks */
@media(max-width:520px){
  .cart-item{flex-direction:column;align-items:stretch}
  .item-right{align-items:flex-start}
  .subtotal-bar{flex-direction:column;align-items:flex-start;gap:8px}
  .actions{flex-direction:column}
}

/* subtle animations */
.fade-up { transform: translateY(6px); opacity: 0; animation: fadeUp .36s ease forwards; }
@keyframes fadeUp { to { transform: translateY(0); opacity:1 } }
</style>
</head>
<body>

<div class="header">
  <div class="title">MINGLE BISTRO (FUNAN) â€” YOUR ORDER</div>
  <div class="sub">Review items, adjust quantities, then place order</div>
</div>

<div class="container" id="mainContainer">

  <!-- Empty fallback -->
  <div id="emptyCt" class="empty-ct" style="display:none;">
    <div class="emoji">ðŸ›’</div>
    <div class="lead">Your cart is empty</div>
    <div class="hint">Go back to the menu to add delicious items.</div>
    <div style="margin-top:8px"><a href="page1.html" class="btn primary">Back to Menu</a></div>
  </div>

  <!-- Cart list -->
  <div id="cartListWrap" style="display:none">
    <div class="cart-list" id="cartList"></div>

    <div class="subtotal-bar fade-up">
      <div class="subtotal-left">Items: <span id="totalItems">0</span></div>
      <div class="subtotal-right">Total: $<span id="totalPrice">0.00</span></div>
    </div>

    <div class="actions">
      <button id="placeOrderBtn" class="btn primary">Place Order</button>
      <a href="page1.html" class="btn" id="backToMenuBtn">Back to Menu</a>
      <button id="clearCartBtn" class="btn">Clear Cart</button>
    </div>
  </div>

</div>

<!-- success overlay -->
<div id="successOverlay" class="success-overlay" role="dialog" aria-modal="true">
  <div class="success-card fade-up">
    <div class="success-head">
      <div>
        <div class="order-number" id="orderNumber">Order #0001</div>
        <div class="order-time" id="orderTime">Dec 11, 2025 â€” 09:00 PM</div>
      </div>
      <div style="text-align:right">
        <div style="font-weight:900;color:var(--gold);font-size:20px">Order Placed</div>
        <div style="color:var(--muted);font-size:13px">Weâ€™re preparing your food now</div>
      </div>
    </div>

    <div class="success-list" id="successList" style="margin-top:14px"></div>

    <div class="success-meta" style="margin-top:12px" id="successMeta"></div>

    <div style="display:flex;gap:8px;margin-top:12px;justify-content:flex-end">
      <a href="page1.html" class="btn primary">Go Back to Menu</a>
      <button id="closeSuccessBtn" class="btn">Close</button>
    </div>
  </div>
</div>

<script>
/* --- Utilities --- */
function getCart(){ try { return JSON.parse(localStorage.getItem('cart') || '[]'); } catch(e){ return []; } }
function setCart(value){ localStorage.setItem('cart', JSON.stringify(value)); }

/* --- Render cart list --- */
function formatCurrency(n){ return Number(n).toFixed(2); }

function renderCart(){
  const cart = getCart();
  const wrap = document.getElementById('cartListWrap');
  const list = document.getElementById('cartList');
  list.innerHTML = '';

  if(!cart || cart.length === 0){
    document.getElementById('emptyCt').style.display = 'flex';
    wrap.style.display = 'none';
    return;
  } else {
    document.getElementById('emptyCt').style.display = 'none';
    wrap.style.display = 'block';
  }

  let total = 0, totalItems = 0;
  cart.forEach((item, idx) => {
    const row = document.createElement('div');
    row.className = 'cart-item fade-up';
    row.dataset.index = idx;

    const left = document.createElement('div');
    left.className = 'item-left';
    const name = document.createElement('div');
    name.className = 'item-name';
    name.textContent = item.name;

    const meta = document.createElement('div');
    meta.className = 'item-meta';

    // Build metadata lines: option, fries, spicy, request
    let metaLines = [];
    if(item.option && item.option !== '') metaLines.push('Option: ' + item.option);
    if(item.fries && item.fries !== '') metaLines.push('Fries: ' + item.fries);
    if(item.spicy && item.spicy !== '') metaLines.push('Spice: ' + (item.spicy === 'non-spicy' ? 'Non-Spicy' : 'Spicy'));
    if(item.request && item.request !== '') metaLines.push('Special: ' + item.request);
    if(metaLines.length === 0 && item.price !== undefined){
      metaLines.push(''); // keep space if none
    }
    meta.textContent = metaLines.join('\n');

    left.appendChild(name);
    left.appendChild(meta);

    const right = document.createElement('div');
    right.className = 'item-right';

    // price small (per item)
    const price = document.createElement('div');
    price.className = 'item-price';
    price.textContent = '$' + formatCurrency(item.price);

    // qty controls
    const qtyRow = document.createElement('div');
    qtyRow.className = 'qty-controls';

    const minus = document.createElement('button');
    minus.className = 'qty-btn';
    minus.textContent = 'âˆ’';
    minus.onclick = function(){ changeQty(idx, -1); };

    const qval = document.createElement('div');
    qval.className = 'qty-val';
    qval.textContent = item.qty;

    const plus = document.createElement('button');
    plus.className = 'qty-btn';
    plus.textContent = '+';
    plus.onclick = function(){ changeQty(idx, 1); };

    qtyRow.appendChild(minus);
    qtyRow.appendChild(qval);
    qtyRow.appendChild(plus);

    // remove button
    const remove = document.createElement('button');
    remove.className = 'remove-btn';
    remove.textContent = 'Remove';
    remove.onclick = function(){ removeItem(idx); };

    right.appendChild(price);
    right.appendChild(qtyRow);
    right.appendChild(remove);

    row.appendChild(left);
    row.appendChild(right);

    list.appendChild(row);

    total += (Number(item.price) || 0) * (Number(item.qty) || 0);
    totalItems += Number(item.qty) || 0;
  });

  document.getElementById('totalPrice').textContent = formatCurrency(total);
  document.getElementById('totalItems').textContent = totalItems;
}

/* --- Quantity & Remove handlers --- */
function changeQty(index, delta){
  const cart = getCart();
  if(!cart[index]) return;
  cart[index].qty = Math.max(1, (Number(cart[index].qty)||1) + delta);
  setCart(cart);
  renderCart();
}

function removeItem(index){
  let cart = getCart();
  cart.splice(index,1);
  setCart(cart);
  renderCart();
}

/* --- Clear cart --- */
document.getElementById('clearCartBtn').addEventListener('click', function(){
  if(!confirm('Clear all items from cart?')) return;
  setCart([]);
  renderCart();
});

/* --- Place Order flow --- */
document.getElementById('placeOrderBtn').addEventListener('click', function(){
  const cart = getCart();
  if(!cart || cart.length === 0){ alert('Cart is empty'); return; }

  // simulate creating an order â€” create order object
  const orderId = 'MB' + String(Math.floor(1000 + Math.random()*9000));
  const ts = new Date();
  const iso = ts.toISOString();
  const readable = ts.toLocaleString(undefined, { year:'numeric', month:'short', day:'numeric', hour:'2-digit', minute:'2-digit' });

  // build summary entries
  const successList = document.getElementById('successList');
  successList.innerHTML = '';
  cart.forEach(it=>{
    const div = document.createElement('div');
    div.className = 'success-item';
    const left = document.createElement('div');
    left.textContent = `x ${it.qty}  ${it.name}`;
    const right = document.createElement('div');
    right.textContent = '$' + formatCurrency( (Number(it.price)||0) * (Number(it.qty)||1) );
    div.appendChild(left);
    div.appendChild(right);
    successList.appendChild(div);

    // details
    if(it.request || it.option || it.fries || it.spicy){
      const d = document.createElement('div');
      d.className = 'success-meta';
      const parts = [];
      if(it.option) parts.push('Option: ' + it.option);
      if(it.fries) parts.push('Fries: ' + it.fries);
      if(it.spicy) parts.push('Spice: ' + (it.spicy === 'non-spicy' ? 'Non-Spicy' : 'Spicy'));
      if(it.request) parts.push('Special: ' + it.request);
      d.textContent = parts.join(' â€¢ ');
      successList.appendChild(d);
    }
  });

  // meta
  const totalSum = cart.reduce((s,it)=>s + (Number(it.price)||0) * (Number(it.qty)||1), 0);
  document.getElementById('orderNumber').textContent = 'Order #' + orderId;
  document.getElementById('orderTime').textContent = readable;
  document.getElementById('successMeta').textContent = `Total: $${formatCurrency(totalSum)} â€¢ ${cart.length} line items`;

  // show overlay
  document.getElementById('successOverlay').style.display = 'flex';
  setTimeout(()=> document.querySelector('.success-card').classList.add('fade-up'), 10);

  // TODO: send order to backend or print â€” currently just save summary locally
  // Save last order snapshot to localStorage (for later printing or retrieval)
  const orders = JSON.parse(localStorage.getItem('orders')||'[]');
  orders.unshift({ id: orderId, created: iso, readable: readable, items: cart.slice(), total: totalSum });
  localStorage.setItem('orders', JSON.stringify(orders));

  // clear cart after showing summary
  setTimeout(()=>{ setCart([]); renderCart(); }, 250);
});

/* --- close success overlay --- */
document.getElementById('closeSuccessBtn').addEventListener('click', function(){
  document.getElementById('successOverlay').style.display = 'none';
});

/* --- init --- */
document.addEventListener('DOMContentLoaded', function(){
  renderCart();

  // keyboard accessibility for clearing
  document.getElementById('backToMenuBtn').addEventListener('click', function(e){
    // fallback: normal link
  });
});
</script>
</body>
</html>